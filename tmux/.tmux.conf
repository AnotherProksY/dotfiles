# Binds---------------------------
unbind C-b
set -g prefix2 C-a          # GNU-Screen compatible prefix
bind C-a send-prefix -2

bind-key tab last-window
bind-key e send-prefix
bind-key l send-keys 'C-l'
bind-key k send-keys "clear && tmux clear-history" \; send-keys "Enter"
bind r source-file ~/.tmux.conf \; display '~/.tmux.conf sourced'

# pane creation
bind - split-window -c "#{pane_current_path}" -v      # split current window horizontally
bind _ split-window -c "#{pane_current_path}" -h      # split current window vertically
bind c new-window -c "#{pane_current_path}"           # create new window

# pane navigation
is_fzf="ps -o state= -o comm= -t '#{pane_tty}' \
  | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?fzf$'"

bind -n C-h select-pane -L  # move left
bind -n C-j run "($is_fzf && tmux send-keys C-j) || \
                         tmux select-pane -D"
bind -n C-k run "($is_fzf && tmux send-keys C-k) || \
                         tmux select-pane -U"
bind -n C-l select-pane -R  # move right

bind > swap-pane -D         # swap current pane with the next one
bind < swap-pane -U         # swap current pane with the previous one

# pane resizing
bind -r H resize-pane -L 2
bind -r J resize-pane -D 2
bind -r K resize-pane -U 2
bind -r L resize-pane -R 2

# copy mode
bind Enter copy-mode        # enter copy mode

run -b 'tmux bind -t vi-copy v begin-selection 2> /dev/null || true'
run -b 'tmux bind -T copy-mode-vi v send -X begin-selection 2> /dev/null || true'
run -b 'tmux bind -t vi-copy C-v rectangle-toggle 2> /dev/null || true'
run -b 'tmux bind -T copy-mode-vi C-v send -X rectangle-toggle 2> /dev/null || true'
run -b 'tmux bind -t vi-copy y copy-selection 2> /dev/null || true'
run -b 'tmux bind -T copy-mode-vi y send -X copy-selection-and-cancel 2> /dev/null || true'
run -b 'tmux bind -t vi-copy Escape cancel 2> /dev/null || true'
run -b 'tmux bind -T copy-mode-vi Escape send -X cancel 2> /dev/null || true'
run -b 'tmux bind -t vi-copy H start-of-line 2> /dev/null || true'
run -b 'tmux bind -T copy-mode-vi H send -X start-of-line 2> /dev/null || true'
run -b 'tmux bind -t vi-copy L end-of-line 2> /dev/null || true'
run -b 'tmux bind -T copy-mode-vi L send -X end-of-line 2> /dev/null || true'
#---------------------------------

# Settings
set-window-option -g xterm-keys on
set -s escape-time 10                     # faster command sequences
set -sg repeat-time 600                   # increase repeat timeout
set -s focus-events on
set-option -g renumber-windows on

set -q -g status-utf8 on                  # expect UTF-8 (tmux < 2.2)
setw -q -g utf8 on

set -g base-index 1
setw -g pane-base-index 1
setw -g mode-keys vi

set -g status-position bottom
set -g status-justify centre
set -g status-left ''
set -g status-right ''
set -g status-bg colour234
set -g status-fg colour255

setw -g window-status-current-format ' #I#[fg=colour250]:#[fg=colour255]#W#[fg=colour10]#F '
setw -g window-status-format ' #I#[fg=colour237]:#[fg=colour250]#W#[fg=colour244]#F '

set-option -g history-limit 20000
